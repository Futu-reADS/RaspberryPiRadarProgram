# Använda filterparametrar
# Andningsfrekvens passband 0.1 - 0.7 Hz
# Hjärtfrekvens passband 0.9 - 3 Hz

import numpy as np

class Filter:
    # MATLAB exported coefficients for FIR filters
    coefficients_lowpass_HR = [-0.00019035,0.00082313,-0.00050543,-0.00068945,0.0013379,-0.00029754,-0.0015094,0.0017592,0.00036995,-0.0025866,0.0018399,0.0016191,-0.0037324,0.0012882,0.0034673,-0.0046258,-0.00017721,0.0057774,-0.0048313,-0.0027617,0.0082242,-0.0038392,-0.0065307,0.010283,-0.0011141,-0.011364,0.011232,0.0038797,-0.01694,0.010127,0.01174,-0.022764,0.0056367,0.023455,-0.028228,-0.0046982,0.041719,-0.032701,-0.028235,0.078236,-0.035635,-0.11556,0.29178,0.62983,0.29178,-0.11556,-0.035635,0.078236,-0.028235,-0.032701,0.041719,-0.0046982,-0.028228,0.023455,0.0056367,-0.022764,0.01174,0.010127,-0.01694,0.0038797,0.011232,-0.011364,-0.0011141,0.010283,-0.0065307,-0.0038392,0.0082242,-0.0027617,-0.0048313,0.0057774,-0.00017721,-0.0046258,0.0034673,0.0012882,-0.0037324,0.0016191,0.0018399,-0.0025866,0.00036995,0.0017592,-0.0015094,-0.00029754,0.0013379,-0.00068945,-0.00050543,0.00082313,-0.00019035]
    coefficients_highpass_HR = [-0.0001015,-9.677e-05,-8.4454e-05,-6.5024e-05,-3.9525e-05,-9.5283e-06,2.2957e-05,5.5616e-05,8.599e-05,0.00011165,0.00013041,0.00014045,0.00014056,0.00013017,0.00010953,7.9623e-05,4.2222e-05,-2.5772e-07,-4.4891e-05,-8.8444e-05,-0.0001276,-0.00015922,-0.00018057,-0.00018954,-0.00018488,-0.00016629,-0.00013449,-9.1236e-05,-3.9217e-05,1.8095e-05,7.6677e-05,0.00013223,0.00018048,0.00021753,0.00024013,0.00024597,0.00023389,0.00020402,0.00015781,9.8006e-05,2.846e-05,-4.608e-05,-0.0001203,-0.00018869,-0.00024596,-0.00028742,-0.00030937,-0.00030941,-0.00028667,-0.00024193,-0.00017763,-9.7775e-05,-7.6465e-06,8.6495e-05,0.00017786,0.00025959,0.00032532,0.00036959,0.00038835,0.00037927,0.00034199,0.00027825,0.00019176,8.8079e-05,-2.5783e-05,-0.00014181,-0.00025154,-0.00034669,-0.00041974,-0.00046455,-0.00047685,-0.00045461,-0.00039829,-0.00031084,-0.00019764,-6.613e-05,7.4653e-05,0.00021468,0.00034365,0.00045174,0.00053031,0.00057263,0.00057442,0.00053421,0.00045359,0.00033718,0.00019234,2.8793e-05,-0.00014208,-0.00030799,-0.00045661,-0.00057652,-0.00065804,-0.00069398,-0.0006803,-0.00061645,-0.00050557,-0.00035431,-0.00017251,2.7456e-05,0.00023151,0.00042485,0.00059299,0.00072289,0.00080388,0.00082858,0.00079348,0.00069939,0.00055143,0.00035881,0.00013431,-0.00010662,-0.00034683,-0.00056875,-0.00075564,-0.0008928,-0.00096879,-0.00097626,-0.0009127,-0.00078069,-0.00058792,-0.00034671,-7.329e-05,0.00021329,0.00049248,0.00074368,0.00094777,0.0010885,0.0011538,0.0011368,0.0010364,0.00085759,0.0006112,0.00031332,-1.5763e-05,-0.0003529,-0.00067373,-0.00095438,-0.0011733,-0.0013127,-0.0013603,-0.0013101,-0.0011629,-0.00092687,-0.00061673,-0.00025304,0.00013916,0.00053207,0.00089706,0.0012067,0.001437,0.0015689,0.0015901,0.001496,0.0012902,0.00098472,0.00059901,0.00015898,-0.0003048,-0.00075919,-0.0011708,-0.0015085,-0.0017456,-0.0018621,-0.0018461,-0.0016951,-0.0014163,-0.0010266,-0.00055114,-2.2263e-05,0.00052303,0.0010455,0.0015064,0.0018705,0.0021084,0.0021995,0.0021327,0.0019087,0.0015391,0.0010468,0.00046411,-0.00016908,-0.00080813,-0.0014067,-0.00192,-0.0023081,-0.0025393,-0.0025921,-0.0024574,-0.0021396,-0.0016563,-0.0010379,-0.00032539,0.00043217,0.001181,0.0018662,0.0024361,0.0028457,0.0030602,0.003058,0.0028326,0.0023934,0.0017658,0.00098952,0.00011633,-0.00079326,-0.0016742,-0.0024614,-0.0030946,-0.0035226,-0.0037074,-0.0036276,-0.0032801,-0.002681,-0.0018656,-0.00088563,0.00019321,0.0012958,0.0023429,0.003256,0.0039641,0.004408,0.0045458,0.004356,0.0038402,0.0030234,0.0019537,0.00069885,-0.00065694,-0.0020191,-0.0032886,-0.0043695,-0.0051751,-0.0056352,-0.0057016,-0.0053523,-0.0045944,-0.0034646,-0.0020283,-0.00037566,0.0013833,0.0031258,0.0047242,0.0060553,0.0070086,0.0074952,0.007455,0.0068623,0.0057296,0.0041084,0.002088,-0.00020888,-0.0026325,-0.0050152,-0.0071818,-0.008961,-0.010198,-0.010764,-0.01057,-0.0095737,-0.0077827,-0.0052621,-0.0021315,0.001438,0.0052315,0.0089997,0.012473,0.015373,0.017435,0.018415,0.018113,0.016381,0.013138,0.0083739,0.002158,-0.0053647,-0.013976,-0.023394,-0.033283,-0.043273,-0.052973,-0.061992,-0.069958,-0.076536,-0.081448,-0.084482,0.91459,-0.084482,-0.081448,-0.076536,-0.069958,-0.061992,-0.052973,-0.043273,-0.033283,-0.023394,-0.013976,-0.0053647,0.002158,0.0083739,0.013138,0.016381,0.018113,0.018415,0.017435,0.015373,0.012473,0.0089997,0.0052315,0.001438,-0.0021315,-0.0052621,-0.0077827,-0.0095737,-0.01057,-0.010764,-0.010198,-0.008961,-0.0071818,-0.0050152,-0.0026325,-0.00020888,0.002088,0.0041084,0.0057296,0.0068623,0.007455,0.0074952,0.0070086,0.0060553,0.0047242,0.0031258,0.0013833,-0.00037566,-0.0020283,-0.0034646,-0.0045944,-0.0053523,-0.0057016,-0.0056352,-0.0051751,-0.0043695,-0.0032886,-0.0020191,-0.00065694,0.00069885,0.0019537,0.0030234,0.0038402,0.004356,0.0045458,0.004408,0.0039641,0.003256,0.0023429,0.0012958,0.00019321,-0.00088563,-0.0018656,-0.002681,-0.0032801,-0.0036276,-0.0037074,-0.0035226,-0.0030946,-0.0024614,-0.0016742,-0.00079326,0.00011633,0.00098952,0.0017658,0.0023934,0.0028326,0.003058,0.0030602,0.0028457,0.0024361,0.0018662,0.001181,0.00043217,-0.00032539,-0.0010379,-0.0016563,-0.0021396,-0.0024574,-0.0025921,-0.0025393,-0.0023081,-0.00192,-0.0014067,-0.00080813,-0.00016908,0.00046411,0.0010468,0.0015391,0.0019087,0.0021327,0.0021995,0.0021084,0.0018705,0.0015064,0.0010455,0.00052303,-2.2263e-05,-0.00055114,-0.0010266,-0.0014163,-0.0016951,-0.0018461,-0.0018621,-0.0017456,-0.0015085,-0.0011708,-0.00075919,-0.0003048,0.00015898,0.00059901,0.00098472,0.0012902,0.001496,0.0015901,0.0015689,0.001437,0.0012067,0.00089706,0.00053207,0.00013916,-0.00025304,-0.00061673,-0.00092687,-0.0011629,-0.0013101,-0.0013603,-0.0013127,-0.0011733,-0.00095438,-0.00067373,-0.0003529,-1.5763e-05,0.00031332,0.0006112,0.00085759,0.0010364,0.0011368,0.0011538,0.0010885,0.00094777,0.00074368,0.00049248,0.00021329,-7.329e-05,-0.00034671,-0.00058792,-0.00078069,-0.0009127,-0.00097626,-0.00096879,-0.0008928,-0.00075564,-0.00056875,-0.00034683,-0.00010662,0.00013431,0.00035881,0.00055143,0.00069939,0.00079348,0.00082858,0.00080388,0.00072289,0.00059299,0.00042485,0.00023151,2.7456e-05,-0.00017251,-0.00035431,-0.00050557,-0.00061645,-0.0006803,-0.00069398,-0.00065804,-0.00057652,-0.00045661,-0.00030799,-0.00014208,2.8793e-05,0.00019234,0.00033718,0.00045359,0.00053421,0.00057442,0.00057263,0.00053031,0.00045174,0.00034365,0.00021468,7.4653e-05,-6.613e-05,-0.00019764,-0.00031084,-0.00039829,-0.00045461,-0.00047685,-0.00046455,-0.00041974,-0.00034669,-0.00025154,-0.00014181,-2.5783e-05,8.8079e-05,0.00019176,0.00027825,0.00034199,0.00037927,0.00038835,0.00036959,0.00032532,0.00025959,0.00017786,8.6495e-05,-7.6465e-06,-9.7775e-05,-0.00017763,-0.00024193,-0.00028667,-0.00030941,-0.00030937,-0.00028742,-0.00024596,-0.00018869,-0.0001203,-4.608e-05,2.846e-05,9.8006e-05,0.00015781,0.00020402,0.00023389,0.00024597,0.00024013,0.00021753,0.00018048,0.00013223,7.6677e-05,1.8095e-05,-3.9217e-05,-9.1236e-05,-0.00013449,-0.00016629,-0.00018488,-0.00018954,-0.00018057,-0.00015922,-0.0001276,-8.8444e-05,-4.4891e-05,-2.5772e-07,4.2222e-05,7.9623e-05,0.00010953,0.00013017,0.00014056,0.00014045,0.00013041,0.00011165,8.599e-05,5.5616e-05,2.2957e-05,-9.5283e-06,-3.9525e-05,-6.5024e-05,-8.4454e-05,-9.677e-05,-0.0001015]
    
    #Test med 40 Hz sampling för högtalare (5-18 Hz passband).
    #coefficients_lowpass_HR = [-0.00096796,0.0013348,-0.0017295,0.0021233,-0.0024793,0.0027536,-0.0028958,0.0028518,-0.0025655,0.0019821,-0.001051,-0.00027109,0.0020168,-0.0042056,0.0068408,-0.0099082,0.013375,-0.017189,0.021281,-0.025564,0.029937,-0.034289,0.038504,-0.04246,0.046042,-0.04914,0.051659,-0.053519,0.054659,0.94575,0.054659,-0.053519,0.051659,-0.04914,0.046042,-0.04246,0.038504,-0.034289,0.029937,-0.025564,0.021281,-0.017189,0.013375,-0.0099082,0.0068408,-0.0042056,0.0020168,-0.00027109,-0.001051,0.0019821,-0.0025655,0.0028518,-0.0028958,0.0027536,-0.0024793,0.0021233,-0.0017295,0.0013348,-0.00096796]
    #coefficients_highpass_HR = [-0.00028286,-0.00020116,1.3182e-05,0.00025663,0.00039095,0.00031997,5.3074e-05,-0.00028424,-0.00050696,-0.00047027,-0.00015949,0.00028373,0.00062277,0.00065052,0.00031229,-0.0002439,-0.00072786,-0.00085646,-0.00051614,0.00015315,0.00080941,0.0010808,0.00077352,-1.8762e-17,-0.00085256,-0.0013131,-0.0010841,-0.00022618,0.00084079,0.0015394,0.0014442,0.00053452,-0.00075639,-0.0017426,-0.0018465,-0.00093201,0.000581,0.0019021,0.0022795,0.0014228,-0.00029622,-0.0019946,-0.0027273,-0.0020077,-0.00011593,0.001994,0.0031696,0.0026838,0.00067254,-0.0018715,-0.0035815,-0.0034442,-0.0013897,0.0015958,0.0039332,0.0042778,0.0022826,-0.0011326,-0.0041899,-0.0051699,-0.0033664,0.00044326,0.004311,0.0061018,0.0046582,0.00051755,-0.004248,-0.0070522,-0.0061801,-0.001807,0.003941,0.0079971,0.007966,0.0035041,-0.0033109,-0.0089114,-0.010074,-0.0057291,0.0022435,0.0097694,0.01261,0.0086854,-0.00055392,-0.010546,-0.015787,-0.012758,-0.0020999,0.011217,0.020066,0.018778,0.0064661,-0.011763,-0.026618,-0.028931,-0.014611,0.012166,0.039353,0.051274,0.035217,-0.012413,-0.083181,-0.15852,-0.21597,0.76228,-0.21597,-0.15852,-0.083181,-0.012413,0.035217,0.051274,0.039353,0.012166,-0.014611,-0.028931,-0.026618,-0.011763,0.0064661,0.018778,0.020066,0.011217,-0.0020999,-0.012758,-0.015787,-0.010546,-0.00055392,0.0086854,0.01261,0.0097694,0.0022435,-0.0057291,-0.010074,-0.0089114,-0.0033109,0.0035041,0.007966,0.0079971,0.003941,-0.001807,-0.0061801,-0.0070522,-0.004248,0.00051755,0.0046582,0.0061018,0.004311,0.00044326,-0.0033664,-0.0051699,-0.0041899,-0.0011326,0.0022826,0.0042778,0.0039332,0.0015958,-0.0013897,-0.0034442,-0.0035815,-0.0018715,0.00067254,0.0026838,0.0031696,0.001994,-0.00011593,-0.0020077,-0.0027273,-0.0019946,-0.00029622,0.0014228,0.0022795,0.0019021,0.000581,-0.00093201,-0.0018465,-0.0017426,-0.00075639,0.00053452,0.0014442,0.0015394,0.00084079,-0.00022618,-0.0010841,-0.0013131,-0.00085256,-1.8762e-17,0.00077352,0.0010808,0.00080941,0.00015315,-0.00051614,-0.00085646,-0.00072786,-0.0002439,0.00031229,0.00065052,0.00062277,0.00028373,-0.00015949,-0.00047027,-0.00050696,-0.00028424,5.3074e-05,0.00031997,0.00039095,0.00025663,1.3182e-05,-0.00020116,-0.00028286]



    coefficients_lowpass_RR = [0.00039575,0.00041817,0.00040248,0.00034199,0.00023366,7.8999e-05,-0.00011532,
                               -0.00033736,-0.00057036,-0.00079364,-0.00098416,-0.0011184,-0.0011747,-0.0011354,
                               -0.00098936,-0.00073383,-0.00037573,6.7617e-05,0.00056874,0.0010913,0.0015921,0.0020245,
                               0.0023419,0.002502,0.0024711,0.0022279,0.0017673,0.0011021,0.0002644,-0.00069535,
                               -0.0017104,-0.0027019,-0.0035839,-0.0042702,-0.0046815,-0.0047528,-0.0044402,-0.0037271,
                               -0.0026278,-0.0011903,0.00050459,0.0023464,0.0042008,0.0059178,0.0073427,0.0083269,
                               0.0087413,0.0084878,0.00751,0.0058025,0.0034161,0.00045984,-0.0029005,-0.0064488,
                               -0.0099288,-0.013058,-0.015544,-0.017102,-0.017477,-0.016459,-0.013901,-0.0097329,
                               -0.0039709,0.0032784,0.011819,0.021372,0.031586,0.042059,0.052352,0.062018,0.070624,
                               0.077776,0.08314,0.086464,0.08759,0.086464,0.08314,0.077776,0.070624,0.062018,0.052352,
                               0.042059,0.031586,0.021372,0.011819,0.0032784,-0.0039709,-0.0097329,-0.013901,-0.016459,
                               -0.017477,-0.017102,-0.015544,-0.013058,-0.0099288,-0.0064488,-0.0029005,0.00045984,
                               0.0034161,0.0058025,0.00751,0.0084878,0.0087413,0.0083269,0.0073427,0.0059178,0.0042008,
                               0.0023464,0.00050459,-0.0011903,-0.0026278,-0.0037271,-0.0044402,-0.0047528,-0.0046815,
                               -0.0042702,-0.0035839,-0.0027019,-0.0017104,-0.00069535,0.0002644,0.0011021,0.0017673,
                               0.0022279,0.0024711,0.002502,0.0023419,0.0020245,0.0015921,0.0010913,0.00056874,
                               6.7617e-05,-0.00037573,-0.00073383,-0.00098936,-0.0011354,-0.0011747,-0.0011184,
                               -0.00098416,-0.00079364,-0.00057036,-0.00033736,-0.00011532,7.8999e-05,0.00023366,
                               0.00034199,0.00040248,0.00041817,0.00039575]

    coefficients_highpass_RR = [5.0237e-05,5.6915e-05,6.3829e-05,7.0964e-05,7.8304e-05,8.583e-05,9.3522e-05,0.00010136,
                                0.00010932,0.00011738,0.00012551,0.00013369,0.00014188,0.00015007,0.00015821,0.00016628,
                                0.00017424,0.00018206,0.00018971,0.00019715,0.00020435,0.00021127,0.00021787,0.00022411,
                                0.00022996,0.00023538,0.00024033,0.00024478,0.00024868,0.00025201,0.00025472,0.00025677,
                                0.00025814,0.00025879,0.00025869,0.00025781,0.0002561,0.00025356,0.00025014,0.00024582,
                                0.00024059,0.00023441,0.00022728,0.00021916,0.00021005,0.00019994,0.00018882,0.00017668,
                                0.00016351,0.00014932,0.00013411,0.00011789,0.00010066,8.2437e-05,6.3239e-05,4.3084e-05,
                                2.1996e-05,1.6959e-18,-2.2872e-05,-4.6587e-05,-7.1108e-05,-9.6392e-05,-0.00012239,
                                -0.00014907,-0.00017636,-0.00020421,-0.00023257,-0.00026137,-0.00029054,-0.00032002,
                                -0.00034974,-0.00037961,-0.00040956,-0.00043951,-0.00046938,-0.00049908,-0.00052851,
                                -0.0005576,-0.00058625,-0.00061437,-0.00064185,-0.00066861,-0.00069455,-0.00071956,
                                -0.00074355,-0.00076642,-0.00078807,-0.0008084,-0.00082732,-0.00084473,-0.00086052,
                                -0.00087461,-0.0008869,-0.0008973,-0.00090573,-0.00091209,-0.00091631,-0.0009183,
                                -0.00091799,-0.00091531,-0.00091018,-0.00090255,-0.00089236,-0.00087954,-0.00086406,
                                -0.00084587,-0.00082493,-0.00080122,-0.0007747,-0.00074536,-0.00071319,-0.00067818,
                                -0.00064034,-0.00059967,-0.0005562,-0.00050995,-0.00046096,-0.00040926,-0.0003549,
                                -0.00029795,-0.00023847,-0.00017653,-0.00011222,-4.5618e-05,2.3164e-05,9.4022e-05,
                                0.00016684,0.0002415,0.00031786,0.00039578,0.00047513,0.00055573,0.00063743,0.00072006,
                                0.00080344,0.00088739,0.00097171,0.0010562,0.0011407,0.0012249,0.0013087,0.0013918,
                                0.0014741,0.0015552,0.0016349,0.0017131,0.0017894,0.0018637,0.0019357,0.0020051,
                                0.0020717,0.0021352,0.0021955,0.0022522,0.0023052,0.0023541,0.0023988,0.0024389,
                                0.0024743,0.0025048,0.00253,0.0025499,0.0025641,0.0025724,0.0025747,0.0025708,0.0025604,
                                0.0025434,0.0025196,0.0024889,0.002451,0.0024059,0.0023534,0.0022934,0.0022258,
                                0.0021505,0.0020674,0.0019763,0.0018774,0.0017704,0.0016554,0.0015324,0.0014013,
                                0.0012622,0.001115,0.00095982,0.00079671,0.00062572,0.00044694,0.00026045,6.6362e-05,
                                -0.00013519,-0.00034408,-0.00056014,-0.00078321,-0.0010131,-0.0012496,-0.0014926,
                                -0.0017417,-0.0019968,-0.0022575,-0.0025238,-0.0027951,-0.0030713,-0.0033521,-0.0036372,
                                -0.0039261,-0.0042187,-0.0045144,-0.0048131,-0.0051143,-0.0054177,-0.0057228,-0.0060293,
                                -0.0063368,-0.0066449,-0.0069532,-0.0072613,-0.0075687,-0.0078752,-0.0081801,-0.0084832,
                                -0.008784,-0.0090821,-0.0093771,-0.0096685,-0.009956,-0.010239,-0.010518,-0.010791,
                                -0.011058,-0.01132,-0.011575,-0.011824,-0.012066,-0.0123,-0.012526,-0.012744,-0.012954,
                                -0.013155,-0.013347,-0.01353,-0.013703,-0.013866,-0.014019,-0.014161,-0.014293,
                                -0.014414,-0.014525,-0.014624,-0.014712,-0.014788,-0.014853,-0.014906,-0.014947,
                                -0.014977,-0.014995,0.98505,-0.014995,-0.014977,-0.014947,-0.014906,-0.014853,-0.014788,
                                -0.014712,-0.014624,-0.014525,-0.014414,-0.014293,-0.014161,-0.014019,-0.013866,
                                -0.013703,-0.01353,-0.013347,-0.013155,-0.012954,-0.012744,-0.012526,-0.0123,-0.012066,
                                -0.011824,-0.011575,-0.01132,-0.011058,-0.010791,-0.010518,-0.010239,-0.009956,
                                -0.0096685,-0.0093771,-0.0090821,-0.008784,-0.0084832,-0.0081801,-0.0078752,-0.0075687,
                                -0.0072613,-0.0069532,-0.0066449,-0.0063368,-0.0060293,-0.0057228,-0.0054177,-0.0051143,
                                -0.0048131,-0.0045144,-0.0042187,-0.0039261,-0.0036372,-0.0033521,-0.0030713,-0.0027951,
                                -0.0025238,-0.0022575,-0.0019968,-0.0017417,-0.0014926,-0.0012496,-0.0010131,
                                -0.00078321,-0.00056014,-0.00034408,-0.00013519,6.6362e-05,0.00026045,0.00044694,
                                0.00062572,0.00079671,0.00095982,0.001115,0.0012622,0.0014013,0.0015324,0.0016554,
                                0.0017704,0.0018774,0.0019763,0.0020674,0.0021505,0.0022258,0.0022934,0.0023534,
                                0.0024059,0.002451,0.0024889,0.0025196,0.0025434,0.0025604,0.0025708,0.0025747,
                                0.0025724,0.0025641,0.0025499,0.00253,0.0025048,0.0024743,0.0024389,0.0023988,
                                0.0023541,0.0023052,0.0022522,0.0021955,0.0021352,0.0020717,0.0020051,0.0019357,
                                0.0018637,0.0017894,0.0017131,0.0016349,0.0015552,0.0014741,0.0013918,0.0013087,
                                0.0012249,0.0011407,0.0010562,0.00097171,0.00088739,0.00080344,0.00072006,0.00063743,
                                0.00055573,0.00047513,0.00039578,0.00031786,0.0002415,0.00016684,9.4022e-05,2.3164e-05,
                                -4.5618e-05,-0.00011222,-0.00017653,-0.00023847,-0.00029795,-0.0003549,-0.00040926,
                                -0.00046096,-0.00050995,-0.0005562,-0.00059967,-0.00064034,-0.00067818,-0.00071319,
                                -0.00074536,-0.0007747,-0.00080122,-0.00082493,-0.00084587,-0.00086406,-0.00087954,
                                -0.00089236,-0.00090255,-0.00091018,-0.00091531,-0.00091799,-0.0009183,-0.00091631,
                                -0.00091209,-0.00090573,-0.0008973,-0.0008869,-0.00087461,-0.00086052,-0.00084473,
                                -0.00082732,-0.0008084,-0.00078807,-0.00076642,-0.00074355,-0.00071956,-0.00069455,
                                -0.00066861,-0.00064185,-0.00061437,-0.00058625,-0.0005576,-0.00052851,-0.00049908,
                                -0.00046938,-0.00043951,-0.00040956,-0.00037961,-0.00034974,-0.00032002,-0.00029054,
                                -0.00026137,-0.00023257,-0.00020421,-0.00017636,-0.00014907,-0.00012239,-9.6392e-05,
                                -7.1108e-05,-4.6587e-05,-2.2872e-05,1.6959e-18,2.1996e-05,4.3084e-05,6.3239e-05,
                                8.2437e-05,0.00010066,0.00011789,0.00013411,0.00014932,0.00016351,0.00017668,0.00018882,
                                0.00019994,0.00021005,0.00021916,0.00022728,0.00023441,0.00024059,0.00024582,0.00025014,
                                0.00025356,0.0002561,0.00025781,0.00025869,0.00025879,0.00025814,0.00025677,0.00025472,
                                0.00025201,0.00024868,0.00024478,0.00024033,0.00023538,0.00022996,0.00022411,0.00021787,
                                0.00021127,0.00020435,0.00019715,0.00018971,0.00018206,0.00017424,0.00016628,0.00015821,
                                0.00015007,0.00014188,0.00013369,0.00012551,0.00011738,0.00010932,0.00010136,9.3522e-05,
                                8.583e-05,7.8304e-05,7.0964e-05,6.3829e-05,5.6915e-05,5.0237e-05]

    def __init__(self, filter_type):
        # Selection of used filter
        if filter_type == 'highpass_HR':
            self.coefficients = Filter.coefficients_highpass_HR
        elif filter_type == 'lowpass_HR':
            self.coefficients = Filter.coefficients_lowpass_HR
        elif filter_type == 'highpass_RR':
            self.coefficients = Filter.coefficients_highpass_RR
        elif filter_type == 'lowpass_RR':
            self.coefficients = Filter.coefficients_lowpass_RR
        
        self.length_of_input_vector = len(self.coefficients)            # Length of coefficient vector and length of input vector
        self.input_vector = np.zeros(self.length_of_input_vector)       # Vector of the same length as coefficients
        self.input_vector_index = 0                                     # To know where the latest input value is in input_vector

    def filter(self, input_value):      # Filters the input value
        self.input_vector[self.input_vector_index] = input_value        # Saves the input data continuously in a vector
        output = 0                                                      # The filtered value. Add all coefficients * (input values) together

        iterate_index = self.input_vector_index                     # Because variable value is changed in order to loop array
        for i in range(0, self.length_of_input_vector - 1):         # Iterate over all coefficients and relevant input values
            if iterate_index - i < 0:                               # If iterate_index is negative, then begin from right hand side and work our way to the left in array
                iterate_index = self.length_of_input_vector + i - 1         # Moving to the rightmost location of array
            output += self.coefficients[i] * self.input_vector[iterate_index - i]       # Add value of coefficient * data

        self.input_vector_index += 1                                    # Note that index is incremented before if statement
        if self.input_vector_index == self.length_of_input_vector:      # Add values from beginning of array if overflow
            self.input_vector_index = 0
        return output