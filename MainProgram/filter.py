import numpy as np

class Filter:
    # MATLAB exported coefficients for FIR filters
    #coefficients_lowpass_HR = [-0.00019035,0.00082313,-0.00050543,-0.00068945,0.0013379,-0.00029754,-0.0015094,0.0017592,0.00036995,-0.0025866,0.0018399,0.0016191,-0.0037324,0.0012882,0.0034673,-0.0046258,-0.00017721,0.0057774,-0.0048313,-0.0027617,0.0082242,-0.0038392,-0.0065307,0.010283,-0.0011141,-0.011364,0.011232,0.0038797,-0.01694,0.010127,0.01174,-0.022764,0.0056367,0.023455,-0.028228,-0.0046982,0.041719,-0.032701,-0.028235,0.078236,-0.035635,-0.11556,0.29178,0.62983,0.29178,-0.11556,-0.035635,0.078236,-0.028235,-0.032701,0.041719,-0.0046982,-0.028228,0.023455,0.0056367,-0.022764,0.01174,0.010127,-0.01694,0.0038797,0.011232,-0.011364,-0.0011141,0.010283,-0.0065307,-0.0038392,0.0082242,-0.0027617,-0.0048313,0.0057774,-0.00017721,-0.0046258,0.0034673,0.0012882,-0.0037324,0.0016191,0.0018399,-0.0025866,0.00036995,0.0017592,-0.0015094,-0.00029754,0.0013379,-0.00068945,-0.00050543,0.00082313,-0.00019035]
    #coefficients_highpass_HR = [-0.0001015,-9.677e-05,-8.4454e-05,-6.5024e-05,-3.9525e-05,-9.5283e-06,2.2957e-05,5.5616e-05,8.599e-05,0.00011165,0.00013041,0.00014045,0.00014056,0.00013017,0.00010953,7.9623e-05,4.2222e-05,-2.5772e-07,-4.4891e-05,-8.8444e-05,-0.0001276,-0.00015922,-0.00018057,-0.00018954,-0.00018488,-0.00016629,-0.00013449,-9.1236e-05,-3.9217e-05,1.8095e-05,7.6677e-05,0.00013223,0.00018048,0.00021753,0.00024013,0.00024597,0.00023389,0.00020402,0.00015781,9.8006e-05,2.846e-05,-4.608e-05,-0.0001203,-0.00018869,-0.00024596,-0.00028742,-0.00030937,-0.00030941,-0.00028667,-0.00024193,-0.00017763,-9.7775e-05,-7.6465e-06,8.6495e-05,0.00017786,0.00025959,0.00032532,0.00036959,0.00038835,0.00037927,0.00034199,0.00027825,0.00019176,8.8079e-05,-2.5783e-05,-0.00014181,-0.00025154,-0.00034669,-0.00041974,-0.00046455,-0.00047685,-0.00045461,-0.00039829,-0.00031084,-0.00019764,-6.613e-05,7.4653e-05,0.00021468,0.00034365,0.00045174,0.00053031,0.00057263,0.00057442,0.00053421,0.00045359,0.00033718,0.00019234,2.8793e-05,-0.00014208,-0.00030799,-0.00045661,-0.00057652,-0.00065804,-0.00069398,-0.0006803,-0.00061645,-0.00050557,-0.00035431,-0.00017251,2.7456e-05,0.00023151,0.00042485,0.00059299,0.00072289,0.00080388,0.00082858,0.00079348,0.00069939,0.00055143,0.00035881,0.00013431,-0.00010662,-0.00034683,-0.00056875,-0.00075564,-0.0008928,-0.00096879,-0.00097626,-0.0009127,-0.00078069,-0.00058792,-0.00034671,-7.329e-05,0.00021329,0.00049248,0.00074368,0.00094777,0.0010885,0.0011538,0.0011368,0.0010364,0.00085759,0.0006112,0.00031332,-1.5763e-05,-0.0003529,-0.00067373,-0.00095438,-0.0011733,-0.0013127,-0.0013603,-0.0013101,-0.0011629,-0.00092687,-0.00061673,-0.00025304,0.00013916,0.00053207,0.00089706,0.0012067,0.001437,0.0015689,0.0015901,0.001496,0.0012902,0.00098472,0.00059901,0.00015898,-0.0003048,-0.00075919,-0.0011708,-0.0015085,-0.0017456,-0.0018621,-0.0018461,-0.0016951,-0.0014163,-0.0010266,-0.00055114,-2.2263e-05,0.00052303,0.0010455,0.0015064,0.0018705,0.0021084,0.0021995,0.0021327,0.0019087,0.0015391,0.0010468,0.00046411,-0.00016908,-0.00080813,-0.0014067,-0.00192,-0.0023081,-0.0025393,-0.0025921,-0.0024574,-0.0021396,-0.0016563,-0.0010379,-0.00032539,0.00043217,0.001181,0.0018662,0.0024361,0.0028457,0.0030602,0.003058,0.0028326,0.0023934,0.0017658,0.00098952,0.00011633,-0.00079326,-0.0016742,-0.0024614,-0.0030946,-0.0035226,-0.0037074,-0.0036276,-0.0032801,-0.002681,-0.0018656,-0.00088563,0.00019321,0.0012958,0.0023429,0.003256,0.0039641,0.004408,0.0045458,0.004356,0.0038402,0.0030234,0.0019537,0.00069885,-0.00065694,-0.0020191,-0.0032886,-0.0043695,-0.0051751,-0.0056352,-0.0057016,-0.0053523,-0.0045944,-0.0034646,-0.0020283,-0.00037566,0.0013833,0.0031258,0.0047242,0.0060553,0.0070086,0.0074952,0.007455,0.0068623,0.0057296,0.0041084,0.002088,-0.00020888,-0.0026325,-0.0050152,-0.0071818,-0.008961,-0.010198,-0.010764,-0.01057,-0.0095737,-0.0077827,-0.0052621,-0.0021315,0.001438,0.0052315,0.0089997,0.012473,0.015373,0.017435,0.018415,0.018113,0.016381,0.013138,0.0083739,0.002158,-0.0053647,-0.013976,-0.023394,-0.033283,-0.043273,-0.052973,-0.061992,-0.069958,-0.076536,-0.081448,-0.084482,0.91459,-0.084482,-0.081448,-0.076536,-0.069958,-0.061992,-0.052973,-0.043273,-0.033283,-0.023394,-0.013976,-0.0053647,0.002158,0.0083739,0.013138,0.016381,0.018113,0.018415,0.017435,0.015373,0.012473,0.0089997,0.0052315,0.001438,-0.0021315,-0.0052621,-0.0077827,-0.0095737,-0.01057,-0.010764,-0.010198,-0.008961,-0.0071818,-0.0050152,-0.0026325,-0.00020888,0.002088,0.0041084,0.0057296,0.0068623,0.007455,0.0074952,0.0070086,0.0060553,0.0047242,0.0031258,0.0013833,-0.00037566,-0.0020283,-0.0034646,-0.0045944,-0.0053523,-0.0057016,-0.0056352,-0.0051751,-0.0043695,-0.0032886,-0.0020191,-0.00065694,0.00069885,0.0019537,0.0030234,0.0038402,0.004356,0.0045458,0.004408,0.0039641,0.003256,0.0023429,0.0012958,0.00019321,-0.00088563,-0.0018656,-0.002681,-0.0032801,-0.0036276,-0.0037074,-0.0035226,-0.0030946,-0.0024614,-0.0016742,-0.00079326,0.00011633,0.00098952,0.0017658,0.0023934,0.0028326,0.003058,0.0030602,0.0028457,0.0024361,0.0018662,0.001181,0.00043217,-0.00032539,-0.0010379,-0.0016563,-0.0021396,-0.0024574,-0.0025921,-0.0025393,-0.0023081,-0.00192,-0.0014067,-0.00080813,-0.00016908,0.00046411,0.0010468,0.0015391,0.0019087,0.0021327,0.0021995,0.0021084,0.0018705,0.0015064,0.0010455,0.00052303,-2.2263e-05,-0.00055114,-0.0010266,-0.0014163,-0.0016951,-0.0018461,-0.0018621,-0.0017456,-0.0015085,-0.0011708,-0.00075919,-0.0003048,0.00015898,0.00059901,0.00098472,0.0012902,0.001496,0.0015901,0.0015689,0.001437,0.0012067,0.00089706,0.00053207,0.00013916,-0.00025304,-0.00061673,-0.00092687,-0.0011629,-0.0013101,-0.0013603,-0.0013127,-0.0011733,-0.00095438,-0.00067373,-0.0003529,-1.5763e-05,0.00031332,0.0006112,0.00085759,0.0010364,0.0011368,0.0011538,0.0010885,0.00094777,0.00074368,0.00049248,0.00021329,-7.329e-05,-0.00034671,-0.00058792,-0.00078069,-0.0009127,-0.00097626,-0.00096879,-0.0008928,-0.00075564,-0.00056875,-0.00034683,-0.00010662,0.00013431,0.00035881,0.00055143,0.00069939,0.00079348,0.00082858,0.00080388,0.00072289,0.00059299,0.00042485,0.00023151,2.7456e-05,-0.00017251,-0.00035431,-0.00050557,-0.00061645,-0.0006803,-0.00069398,-0.00065804,-0.00057652,-0.00045661,-0.00030799,-0.00014208,2.8793e-05,0.00019234,0.00033718,0.00045359,0.00053421,0.00057442,0.00057263,0.00053031,0.00045174,0.00034365,0.00021468,7.4653e-05,-6.613e-05,-0.00019764,-0.00031084,-0.00039829,-0.00045461,-0.00047685,-0.00046455,-0.00041974,-0.00034669,-0.00025154,-0.00014181,-2.5783e-05,8.8079e-05,0.00019176,0.00027825,0.00034199,0.00037927,0.00038835,0.00036959,0.00032532,0.00025959,0.00017786,8.6495e-05,-7.6465e-06,-9.7775e-05,-0.00017763,-0.00024193,-0.00028667,-0.00030941,-0.00030937,-0.00028742,-0.00024596,-0.00018869,-0.0001203,-4.608e-05,2.846e-05,9.8006e-05,0.00015781,0.00020402,0.00023389,0.00024597,0.00024013,0.00021753,0.00018048,0.00013223,7.6677e-05,1.8095e-05,-3.9217e-05,-9.1236e-05,-0.00013449,-0.00016629,-0.00018488,-0.00018954,-0.00018057,-0.00015922,-0.0001276,-8.8444e-05,-4.4891e-05,-2.5772e-07,4.2222e-05,7.9623e-05,0.00010953,0.00013017,0.00014056,0.00014045,0.00013041,0.00011165,8.599e-05,5.5616e-05,2.2957e-05,-9.5283e-06,-3.9525e-05,-6.5024e-05,-8.4454e-05,-9.677e-05,-0.0001015]
    #Test med 40 Hz sampling för högtalare.
    coefficients_lowpass_HR = [-9.515e-05,0.0002448,0.00041146,0.00019995,-0.00025265,-0.00053964,-0.00034463,0.00022433,0.00066877,0.00053017,-0.00014873,-0.00078686,-0.00075451,1.5323e-05,0.00087937,0.001012,0.00018493,-0.00092968,-0.001293,-0.00045868,0.00091969,0.0015836,0.00080931,-0.00083061,-0.0018657,-0.001236,0.00064394,0.0021172,0.0017332,-0.00034248,-0.0023123,-0.0022895,-8.8581e-05,0.002422,0.0028879,0.00066061,-0.002415,-0.003505,-0.0013805,0.0022585,0.004111,0.0022499,-0.0019191,-0.0046701,-0.0032645,0.001363,0.0051402,0.0044136,-0.00055692,-0.0054732,-0.0056803,-0.00053241,0.0056144,0.0070412,0.0019394,-0.0055016,-0.0084677,-0.0037022,0.0050619,0.0099261,0.0058687,-0.0042064,-0.011379,-0.0085066,0.0028176,0.012787,0.011725,-0.00072524,-0.01411,-0.015716,-0.0023485,0.015309,0.020854,0.00692,-0.016346,-0.027955,-0.014114,0.01719,0.039108,0.026982,-0.017813,-0.061515,-0.057765,0.018195,0.14585,0.26584,0.31483,0.26584,0.14585,0.018195,-0.057765,-0.061515,-0.017813,0.026982,0.039108,0.01719,-0.014114,-0.027955,-0.016346,0.00692,0.020854,0.015309,-0.0023485,-0.015716,-0.01411,-0.00072524,0.011725,0.012787,0.0028176,-0.0085066,-0.011379,-0.0042064,0.0058687,0.0099261,0.0050619,-0.0037022,-0.0084677,-0.0055016,0.0019394,0.0070412,0.0056144,-0.00053241,-0.0056803,-0.0054732,-0.00055692,0.0044136,0.0051402,0.001363,-0.0032645,-0.0046701,-0.0019191,0.0022499,0.004111,0.0022585,-0.0013805,-0.003505,-0.002415,0.00066061,0.0028879,0.002422,-8.8581e-05,-0.0022895,-0.0023123,-0.00034248,0.0017332,0.0021172,0.00064394,-0.001236,-0.0018657,-0.00083061,0.00080931,0.0015836,0.00091969,-0.00045868,-0.001293,-0.00092968,0.00018493,0.001012,0.00087937,1.5323e-05,-0.00075451,-0.00078686,-0.00014873,0.00053017,0.00066877,0.00022433,-0.00034463,-0.00053964,-0.00025265,0.00019995,0.00041146,0.0002448,-9.515e-05]
    coefficients_highpass_HR = [-4.9362e-05,-4.7731e-05,-4.5159e-05,-4.1667e-05,-3.7292e-05,-3.2089e-05,-2.6132e-05,-1.951e-05,-1.2328e-05,-4.7046e-06,3.2306e-06,1.1337e-05,1.9469e-05,2.7473e-05,3.5196e-05,4.2486e-05,4.9194e-05,5.5178e-05,6.0306e-05,6.4459e-05,6.7532e-05,6.9438e-05,7.0111e-05,6.9503e-05,6.7594e-05,6.4382e-05,5.9894e-05,5.418e-05,4.7314e-05,3.9394e-05,3.054e-05,2.0893e-05,1.0612e-05,-1.2755e-07,-1.1138e-05,-2.2222e-05,-3.3174e-05,-4.3788e-05,-5.3859e-05,-6.3186e-05,-7.1577e-05,-7.8855e-05,-8.4856e-05,-8.9439e-05,-9.2484e-05,-9.3898e-05,-9.3617e-05,-9.1604e-05,-8.7857e-05,-8.2403e-05,-7.5305e-05,-6.6654e-05,-5.6576e-05,-4.5223e-05,-3.2776e-05,-1.9441e-05,-5.444e-06,8.9716e-06,2.3548e-05,3.8021e-05,5.2119e-05,6.5574e-05,7.8124e-05,8.9516e-05,9.9514e-05,0.0001079,0.0001145,0.00011913,0.00012167,0.00012204,0.00012017,0.00011606,0.00010973,0.00010125,9.0728e-05,7.8324e-05,6.4222e-05,4.8646e-05,3.1854e-05,1.4128e-05,-4.2239e-06,-2.2877e-05,-4.1493e-05,-5.973e-05,-7.7244e-05,-9.3698e-05,-0.00010877,-0.00012215,-0.00013356,-0.00014275,-0.00014951,-0.00015367,-0.00015509,-0.0001537,-0.00014947,-0.00014241,-0.00013261,-0.0001202,-0.00010534,-8.8261e-05,-6.924e-05,-4.8586e-05,-2.6646e-05,-3.8e-06,1.9551e-05,4.2987e-05,6.6081e-05,8.8401e-05,0.00010952,0.00012904,0.00014656,0.00016172,0.00017421,0.00018374,0.00019009,0.00019308,0.0001926,0.00018858,0.00018104,0.00017006,0.00015577,0.00013837,0.00011813,9.5368e-05,7.0454e-05,4.3807e-05,1.5885e-05,-1.2824e-05,-4.1808e-05,-7.0541e-05,-9.8491e-05,-0.00012513,-0.00014996,-0.00017248,-0.00019224,-0.00020883,-0.0002219,-0.00023114,-0.00023632,-0.00023728,-0.00023392,-0.00022623,-0.00021428,-0.00019821,-0.00017825,-0.0001547,-0.00012793,-9.8369e-05,-6.6516e-05,-3.2916e-05,1.8488e-06,3.716e-05,7.2382e-05,0.00010687,0.00013998,0.00017108,0.00019958,0.0002249,0.00024654,0.00026403,0.000277,0.00028512,0.00028817,0.00028602,0.00027862,0.00026602,0.00024836,0.00022588,0.00019893,0.00016792,0.00013335,9.5794e-05,5.5894e-05,1.4341e-05,-2.8134e-05,-7.0768e-05,-0.00011279,-0.00015341,-0.00019188,-0.00022746,-0.00025944,-0.0002872,-0.00031016,-0.00032783,-0.00033979,-0.00034575,-0.0003455,-0.00033895,-0.00032612,-0.00030715,-0.00028229,-0.00025191,-0.00021648,-0.00017655,-0.0001328,-8.5966e-05,-3.685e-05,1.3683e-05,6.4733e-05,0.00011538,0.00016469,0.00021174,0.00025564,0.00029555,0.00033068,0.00036031,0.00038382,0.00040069,0.00041052,0.00041302,0.00040803,0.00039554,0.00037566,0.00034865,0.00031489,0.0002749,0.00022932,0.00017888,0.00012445,6.6961e-05,7.4049e-06,-5.3157e-05,-0.00011364,-0.00017293,-0.00022994,-0.00028359,-0.00033286,-0.00037679,-0.0004145,-0.0004452,-0.00046825,-0.00048311,-0.00048939,-0.00048685,-0.00047542,-0.00045517,-0.00042635,-0.00038935,-0.00034474,-0.00029322,-0.00023563,-0.00017292,-0.00010618,-3.6555e-05,3.4725e-05,0.00010639,0.00017713,0.00024565,0.00031068,0.00037097,0.00042536,0.00047279,0.00051228,0.00054301,0.00056429,0.00057561,0.00057661,0.00056714,0.00054722,0.00051707,0.00047709,0.00042787,0.00037018,0.00030495,0.00023326,0.00015633,7.5482e-05,-7.8649e-06,-9.2229e-05,-0.00017609,-0.00025791,-0.00033618,-0.00040943,-0.00047624,-0.00053532,-0.00058548,-0.00062569,-0.00065508,-0.00067296,-0.00067886,-0.00067248,-0.0006538,-0.00062296,-0.00058037,-0.00052664,-0.00046259,-0.00038924,-0.00030781,-0.00021966,-0.0001263,-2.9354e-05,6.9458e-05,0.00016837,0.00026558,0.00035929,0.00044777,0.00052932,0.00060237,0.00066547,0.00071733,0.00075687,0.00078319,0.00079564,0.00079379,0.00077748,0.00074681,0.00070215,0.00064411,0.00057356,0.00049161,0.0003996,0.00029905,0.00019169,7.9373e-05,-3.5936e-05,-0.00015218,-0.00026725,-0.00037905,-0.0004855,-0.00058459,-0.00067441,-0.00075322,-0.00081941,-0.00087163,-0.00090872,-0.0009298,-0.00093427,-0.00092182,-0.00089244,-0.00084643,-0.0007844,-0.00070725,-0.00061618,-0.00051264,-0.00039835,-0.00027523,-0.0001454,-1.1118e-05,0.00012523,0.0002612,0.00039432,0.00052212,0.00064221,0.00075231,0.00085028,0.00093415,0.0010022,0.001053,0.0010854,0.0010985,0.0010918,0.0010652,0.0010188,0.0009533,0.00086951,0.00076873,0.00065254,0.00052285,0.00038181,0.00023182,7.5483e-05,-8.4453e-05,-0.00024514,-0.00040366,-0.00055712,-0.00070265,-0.0008375,-0.00095906,-0.0010649,-0.001153,-0.0012214,-0.0012685,-0.0012933,-0.0012949,-0.001273,-0.0012276,-0.0011593,-0.0010688,-0.00095767,-0.00082744,-0.00068025,-0.00051851,-0.00034496,-0.00016256,2.5506e-05,0.00021591,0.00040523,0.00059002,0.00076684,0.00093239,0.0010835,0.0012171,0.0013307,0.0014218,0.0014884,0.001529,0.0015424,0.0015279,0.0014854,0.0014153,0.0013183,0.0011959,0.0010498,0.00088231,0.00069616,0.00049443,0.00028052,5.8126e-05,-0.00016885,-0.00039638,-0.00062032,-0.00083657,-0.0010411,-0.00123,-0.0013995,-0.0015464,-0.0016675,-0.0017602,-0.0018225,-0.0018526,-0.0018496,-0.0018128,-0.0017424,-0.0016391,-0.0015043,-0.0013398,-0.0011481,-0.00093229,-0.0006958,-0.00044258,-0.00017693,9.6552e-05,0.00037305,0.00064759,0.00091518,0.0011708,0.0014097,0.0016272,0.001819,0.0019811,0.0021101,0.002203,0.0022575,0.0022719,0.0022452,0.002177,0.002068,0.0019193,0.0017327,0.0015111,0.0012576,0.00097642,0.00067195,0.00034928,1.3916e-05,-0.00032834,-0.00067142,-0.0010091,-0.0013353,-0.0016437,-0.0019285,-0.0021839,-0.0024049,-0.0025866,-0.002725,-0.0028166,-0.0028588,-0.0028498,-0.0027886,-0.0026752,-0.0025105,-0.0022964,-0.0020356,-0.0017317,-0.0013894,-0.0010138,-0.00061107,-0.00018777,0.00024892,0.00069144,0.0011319,0.0015624,0.0019749,0.0023614,0.0027145,0.0030268,0.0032917,0.0035033,0.0036564,0.0037466,0.0037707,0.0037265,0.003613,0.0034303,0.0031798,0.0028641,0.002487,0.0020537,0.0015702,0.0010437,0.00048253,-0.00010441,-0.00070734,-0.0013159,-0.0019195,-0.002507,-0.0030675,-0.0035901,-0.0040641,-0.0044795,-0.0048269,-0.0050977,-0.0052845,-0.0053809,-0.0053819,-0.0052841,-0.0050855,-0.0047858,-0.0043865,-0.0038905,-0.003303,-0.0026305,-0.0018814,-0.0010655,-0.00019451,0.00071888,0.0016605,0.0026152,0.003567,0.004499,0.0053942,0.0062352,0.0070046,0.0076854,0.0082611,0.008716,0.0090354,0.0092061,0.009216,0.009055,0.0087149,0.0081892,0.0074741,0.0065678,0.0054708,0.0041863,0.0027196,0.0010788,-0.00072588,-0.0026819,-0.0047745,-0.0069869,-0.0093005,-0.011695,-0.014149,-0.016639,-0.019142,-0.021633,-0.024088,-0.026482,-0.028791,-0.030991,-0.033059,-0.034973,-0.036714,-0.038262,-0.039602,-0.040718,-0.041599,-0.042235,-0.042619,0.9572,-0.042619,-0.042235,-0.041599,-0.040718,-0.039602,-0.038262,-0.036714,-0.034973,-0.033059,-0.030991,-0.028791,-0.026482,-0.024088,-0.021633,-0.019142,-0.016639,-0.014149,-0.011695,-0.0093005,-0.0069869,-0.0047745,-0.0026819,-0.00072588,0.0010788,0.0027196,0.0041863,0.0054708,0.0065678,0.0074741,0.0081892,0.0087149,0.009055,0.009216,0.0092061,0.0090354,0.008716,0.0082611,0.0076854,0.0070046,0.0062352,0.0053942,0.004499,0.003567,0.0026152,0.0016605,0.00071888,-0.00019451,-0.0010655,-0.0018814,-0.0026305,-0.003303,-0.0038905,-0.0043865,-0.0047858,-0.0050855,-0.0052841,-0.0053819,-0.0053809,-0.0052845,-0.0050977,-0.0048269,-0.0044795,-0.0040641,-0.0035901,-0.0030675,-0.002507,-0.0019195,-0.0013159,-0.00070734,-0.00010441,0.00048253,0.0010437,0.0015702,0.0020537,0.002487,0.0028641,0.0031798,0.0034303,0.003613,0.0037265,0.0037707,0.0037466,0.0036564,0.0035033,0.0032917,0.0030268,0.0027145,0.0023614,0.0019749,0.0015624,0.0011319,0.00069144,0.00024892,-0.00018777,-0.00061107,-0.0010138,-0.0013894,-0.0017317,-0.0020356,-0.0022964,-0.0025105,-0.0026752,-0.0027886,-0.0028498,-0.0028588,-0.0028166,-0.002725,-0.0025866,-0.0024049,-0.0021839,-0.0019285,-0.0016437,-0.0013353,-0.0010091,-0.00067142,-0.00032834,1.3916e-05,0.00034928,0.00067195,0.00097642,0.0012576,0.0015111,0.0017327,0.0019193,0.002068,0.002177,0.0022452,0.0022719,0.0022575,0.002203,0.0021101,0.0019811,0.001819,0.0016272,0.0014097,0.0011708,0.00091518,0.00064759,0.00037305,9.6552e-05,-0.00017693,-0.00044258,-0.0006958,-0.00093229,-0.0011481,-0.0013398,-0.0015043,-0.0016391,-0.0017424,-0.0018128,-0.0018496,-0.0018526,-0.0018225,-0.0017602,-0.0016675,-0.0015464,-0.0013995,-0.00123,-0.0010411,-0.00083657,-0.00062032,-0.00039638,-0.00016885,5.8126e-05,0.00028052,0.00049443,0.00069616,0.00088231,0.0010498,0.0011959,0.0013183,0.0014153,0.0014854,0.0015279,0.0015424,0.001529,0.0014884,0.0014218,0.0013307,0.0012171,0.0010835,0.00093239,0.00076684,0.00059002,0.00040523,0.00021591,2.5506e-05,-0.00016256,-0.00034496,-0.00051851,-0.00068025,-0.00082744,-0.00095767,-0.0010688,-0.0011593,-0.0012276,-0.001273,-0.0012949,-0.0012933,-0.0012685,-0.0012214,-0.001153,-0.0010649,-0.00095906,-0.0008375,-0.00070265,-0.00055712,-0.00040366,-0.00024514,-8.4453e-05,7.5483e-05,0.00023182,0.00038181,0.00052285,0.00065254,0.00076873,0.00086951,0.0009533,0.0010188,0.0010652,0.0010918,0.0010985,0.0010854,0.001053,0.0010022,0.00093415,0.00085028,0.00075231,0.00064221,0.00052212,0.00039432,0.0002612,0.00012523,-1.1118e-05,-0.0001454,-0.00027523,-0.00039835,-0.00051264,-0.00061618,-0.00070725,-0.0007844,-0.00084643,-0.00089244,-0.00092182,-0.00093427,-0.0009298,-0.00090872,-0.00087163,-0.00081941,-0.00075322,-0.00067441,-0.00058459,-0.0004855,-0.00037905,-0.00026725,-0.00015218,-3.5936e-05,7.9373e-05,0.00019169,0.00029905,0.0003996,0.00049161,0.00057356,0.00064411,0.00070215,0.00074681,0.00077748,0.00079379,0.00079564,0.00078319,0.00075687,0.00071733,0.00066547,0.00060237,0.00052932,0.00044777,0.00035929,0.00026558,0.00016837,6.9458e-05,-2.9354e-05,-0.0001263,-0.00021966,-0.00030781,-0.00038924,-0.00046259,-0.00052664,-0.00058037,-0.00062296,-0.0006538,-0.00067248,-0.00067886,-0.00067296,-0.00065508,-0.00062569,-0.00058548,-0.00053532,-0.00047624,-0.00040943,-0.00033618,-0.00025791,-0.00017609,-9.2229e-05,-7.8649e-06,7.5482e-05,0.00015633,0.00023326,0.00030495,0.00037018,0.00042787,0.00047709,0.00051707,0.00054722,0.00056714,0.00057661,0.00057561,0.00056429,0.00054301,0.00051228,0.00047279,0.00042536,0.00037097,0.00031068,0.00024565,0.00017713,0.00010639,3.4725e-05,-3.6555e-05,-0.00010618,-0.00017292,-0.00023563,-0.00029322,-0.00034474,-0.00038935,-0.00042635,-0.00045517,-0.00047542,-0.00048685,-0.00048939,-0.00048311,-0.00046825,-0.0004452,-0.0004145,-0.00037679,-0.00033286,-0.00028359,-0.00022994,-0.00017293,-0.00011364,-5.3157e-05,7.4049e-06,6.6961e-05,0.00012445,0.00017888,0.00022932,0.0002749,0.00031489,0.00034865,0.00037566,0.00039554,0.00040803,0.00041302,0.00041052,0.00040069,0.00038382,0.00036031,0.00033068,0.00029555,0.00025564,0.00021174,0.00016469,0.00011538,6.4733e-05,1.3683e-05,-3.685e-05,-8.5966e-05,-0.0001328,-0.00017655,-0.00021648,-0.00025191,-0.00028229,-0.00030715,-0.00032612,-0.00033895,-0.0003455,-0.00034575,-0.00033979,-0.00032783,-0.00031016,-0.0002872,-0.00025944,-0.00022746,-0.00019188,-0.00015341,-0.00011279,-7.0768e-05,-2.8134e-05,1.4341e-05,5.5894e-05,9.5794e-05,0.00013335,0.00016792,0.00019893,0.00022588,0.00024836,0.00026602,0.00027862,0.00028602,0.00028817,0.00028512,0.000277,0.00026403,0.00024654,0.0002249,0.00019958,0.00017108,0.00013998,0.00010687,7.2382e-05,3.716e-05,1.8488e-06,-3.2916e-05,-6.6516e-05,-9.8369e-05,-0.00012793,-0.0001547,-0.00017825,-0.00019821,-0.00021428,-0.00022623,-0.00023392,-0.00023728,-0.00023632,-0.00023114,-0.0002219,-0.00020883,-0.00019224,-0.00017248,-0.00014996,-0.00012513,-9.8491e-05,-7.0541e-05,-4.1808e-05,-1.2824e-05,1.5885e-05,4.3807e-05,7.0454e-05,9.5368e-05,0.00011813,0.00013837,0.00015577,0.00017006,0.00018104,0.00018858,0.0001926,0.00019308,0.00019009,0.00018374,0.00017421,0.00016172,0.00014656,0.00012904,0.00010952,8.8401e-05,6.6081e-05,4.2987e-05,1.9551e-05,-3.8e-06,-2.6646e-05,-4.8586e-05,-6.924e-05,-8.8261e-05,-0.00010534,-0.0001202,-0.00013261,-0.00014241,-0.00014947,-0.0001537,-0.00015509,-0.00015367,-0.00014951,-0.00014275,-0.00013356,-0.00012215,-0.00010877,-9.3698e-05,-7.7244e-05,-5.973e-05,-4.1493e-05,-2.2877e-05,-4.2239e-06,1.4128e-05,3.1854e-05,4.8646e-05,6.4222e-05,7.8324e-05,9.0728e-05,0.00010125,0.00010973,0.00011606,0.00012017,0.00012204,0.00012167,0.00011913,0.0001145,0.0001079,9.9514e-05,8.9516e-05,7.8124e-05,6.5574e-05,5.2119e-05,3.8021e-05,2.3548e-05,8.9716e-06,-5.444e-06,-1.9441e-05,-3.2776e-05,-4.5223e-05,-5.6576e-05,-6.6654e-05,-7.5305e-05,-8.2403e-05,-8.7857e-05,-9.1604e-05,-9.3617e-05,-9.3898e-05,-9.2484e-05,-8.9439e-05,-8.4856e-05,-7.8855e-05,-7.1577e-05,-6.3186e-05,-5.3859e-05,-4.3788e-05,-3.3174e-05,-2.2222e-05,-1.1138e-05,-1.2755e-07,1.0612e-05,2.0893e-05,3.054e-05,3.9394e-05,4.7314e-05,5.418e-05,5.9894e-05,6.4382e-05,6.7594e-05,6.9503e-05,7.0111e-05,6.9438e-05,6.7532e-05,6.4459e-05,6.0306e-05,5.5178e-05,4.9194e-05,4.2486e-05,3.5196e-05,2.7473e-05,1.9469e-05,1.1337e-05,3.2306e-06,-4.7046e-06,-1.2328e-05,-1.951e-05,-2.6132e-05,-3.2089e-05,-3.7292e-05,-4.1667e-05,-4.5159e-05,-4.7731e-05,-4.9362e-05]




    coefficients_lowpass_RR = [0.00039575,0.00041817,0.00040248,0.00034199,0.00023366,7.8999e-05,-0.00011532,
                               -0.00033736,-0.00057036,-0.00079364,-0.00098416,-0.0011184,-0.0011747,-0.0011354,
                               -0.00098936,-0.00073383,-0.00037573,6.7617e-05,0.00056874,0.0010913,0.0015921,0.0020245,
                               0.0023419,0.002502,0.0024711,0.0022279,0.0017673,0.0011021,0.0002644,-0.00069535,
                               -0.0017104,-0.0027019,-0.0035839,-0.0042702,-0.0046815,-0.0047528,-0.0044402,-0.0037271,
                               -0.0026278,-0.0011903,0.00050459,0.0023464,0.0042008,0.0059178,0.0073427,0.0083269,
                               0.0087413,0.0084878,0.00751,0.0058025,0.0034161,0.00045984,-0.0029005,-0.0064488,
                               -0.0099288,-0.013058,-0.015544,-0.017102,-0.017477,-0.016459,-0.013901,-0.0097329,
                               -0.0039709,0.0032784,0.011819,0.021372,0.031586,0.042059,0.052352,0.062018,0.070624,
                               0.077776,0.08314,0.086464,0.08759,0.086464,0.08314,0.077776,0.070624,0.062018,0.052352,
                               0.042059,0.031586,0.021372,0.011819,0.0032784,-0.0039709,-0.0097329,-0.013901,-0.016459,
                               -0.017477,-0.017102,-0.015544,-0.013058,-0.0099288,-0.0064488,-0.0029005,0.00045984,
                               0.0034161,0.0058025,0.00751,0.0084878,0.0087413,0.0083269,0.0073427,0.0059178,0.0042008,
                               0.0023464,0.00050459,-0.0011903,-0.0026278,-0.0037271,-0.0044402,-0.0047528,-0.0046815,
                               -0.0042702,-0.0035839,-0.0027019,-0.0017104,-0.00069535,0.0002644,0.0011021,0.0017673,
                               0.0022279,0.0024711,0.002502,0.0023419,0.0020245,0.0015921,0.0010913,0.00056874,
                               6.7617e-05,-0.00037573,-0.00073383,-0.00098936,-0.0011354,-0.0011747,-0.0011184,
                               -0.00098416,-0.00079364,-0.00057036,-0.00033736,-0.00011532,7.8999e-05,0.00023366,
                               0.00034199,0.00040248,0.00041817,0.00039575]

    coefficients_highpass_RR = [5.0237e-05,5.6915e-05,6.3829e-05,7.0964e-05,7.8304e-05,8.583e-05,9.3522e-05,0.00010136,
                                0.00010932,0.00011738,0.00012551,0.00013369,0.00014188,0.00015007,0.00015821,0.00016628,
                                0.00017424,0.00018206,0.00018971,0.00019715,0.00020435,0.00021127,0.00021787,0.00022411,
                                0.00022996,0.00023538,0.00024033,0.00024478,0.00024868,0.00025201,0.00025472,0.00025677,
                                0.00025814,0.00025879,0.00025869,0.00025781,0.0002561,0.00025356,0.00025014,0.00024582,
                                0.00024059,0.00023441,0.00022728,0.00021916,0.00021005,0.00019994,0.00018882,0.00017668,
                                0.00016351,0.00014932,0.00013411,0.00011789,0.00010066,8.2437e-05,6.3239e-05,4.3084e-05,
                                2.1996e-05,1.6959e-18,-2.2872e-05,-4.6587e-05,-7.1108e-05,-9.6392e-05,-0.00012239,
                                -0.00014907,-0.00017636,-0.00020421,-0.00023257,-0.00026137,-0.00029054,-0.00032002,
                                -0.00034974,-0.00037961,-0.00040956,-0.00043951,-0.00046938,-0.00049908,-0.00052851,
                                -0.0005576,-0.00058625,-0.00061437,-0.00064185,-0.00066861,-0.00069455,-0.00071956,
                                -0.00074355,-0.00076642,-0.00078807,-0.0008084,-0.00082732,-0.00084473,-0.00086052,
                                -0.00087461,-0.0008869,-0.0008973,-0.00090573,-0.00091209,-0.00091631,-0.0009183,
                                -0.00091799,-0.00091531,-0.00091018,-0.00090255,-0.00089236,-0.00087954,-0.00086406,
                                -0.00084587,-0.00082493,-0.00080122,-0.0007747,-0.00074536,-0.00071319,-0.00067818,
                                -0.00064034,-0.00059967,-0.0005562,-0.00050995,-0.00046096,-0.00040926,-0.0003549,
                                -0.00029795,-0.00023847,-0.00017653,-0.00011222,-4.5618e-05,2.3164e-05,9.4022e-05,
                                0.00016684,0.0002415,0.00031786,0.00039578,0.00047513,0.00055573,0.00063743,0.00072006,
                                0.00080344,0.00088739,0.00097171,0.0010562,0.0011407,0.0012249,0.0013087,0.0013918,
                                0.0014741,0.0015552,0.0016349,0.0017131,0.0017894,0.0018637,0.0019357,0.0020051,
                                0.0020717,0.0021352,0.0021955,0.0022522,0.0023052,0.0023541,0.0023988,0.0024389,
                                0.0024743,0.0025048,0.00253,0.0025499,0.0025641,0.0025724,0.0025747,0.0025708,0.0025604,
                                0.0025434,0.0025196,0.0024889,0.002451,0.0024059,0.0023534,0.0022934,0.0022258,
                                0.0021505,0.0020674,0.0019763,0.0018774,0.0017704,0.0016554,0.0015324,0.0014013,
                                0.0012622,0.001115,0.00095982,0.00079671,0.00062572,0.00044694,0.00026045,6.6362e-05,
                                -0.00013519,-0.00034408,-0.00056014,-0.00078321,-0.0010131,-0.0012496,-0.0014926,
                                -0.0017417,-0.0019968,-0.0022575,-0.0025238,-0.0027951,-0.0030713,-0.0033521,-0.0036372,
                                -0.0039261,-0.0042187,-0.0045144,-0.0048131,-0.0051143,-0.0054177,-0.0057228,-0.0060293,
                                -0.0063368,-0.0066449,-0.0069532,-0.0072613,-0.0075687,-0.0078752,-0.0081801,-0.0084832,
                                -0.008784,-0.0090821,-0.0093771,-0.0096685,-0.009956,-0.010239,-0.010518,-0.010791,
                                -0.011058,-0.01132,-0.011575,-0.011824,-0.012066,-0.0123,-0.012526,-0.012744,-0.012954,
                                -0.013155,-0.013347,-0.01353,-0.013703,-0.013866,-0.014019,-0.014161,-0.014293,
                                -0.014414,-0.014525,-0.014624,-0.014712,-0.014788,-0.014853,-0.014906,-0.014947,
                                -0.014977,-0.014995,0.98505,-0.014995,-0.014977,-0.014947,-0.014906,-0.014853,-0.014788,
                                -0.014712,-0.014624,-0.014525,-0.014414,-0.014293,-0.014161,-0.014019,-0.013866,
                                -0.013703,-0.01353,-0.013347,-0.013155,-0.012954,-0.012744,-0.012526,-0.0123,-0.012066,
                                -0.011824,-0.011575,-0.01132,-0.011058,-0.010791,-0.010518,-0.010239,-0.009956,
                                -0.0096685,-0.0093771,-0.0090821,-0.008784,-0.0084832,-0.0081801,-0.0078752,-0.0075687,
                                -0.0072613,-0.0069532,-0.0066449,-0.0063368,-0.0060293,-0.0057228,-0.0054177,-0.0051143,
                                -0.0048131,-0.0045144,-0.0042187,-0.0039261,-0.0036372,-0.0033521,-0.0030713,-0.0027951,
                                -0.0025238,-0.0022575,-0.0019968,-0.0017417,-0.0014926,-0.0012496,-0.0010131,
                                -0.00078321,-0.00056014,-0.00034408,-0.00013519,6.6362e-05,0.00026045,0.00044694,
                                0.00062572,0.00079671,0.00095982,0.001115,0.0012622,0.0014013,0.0015324,0.0016554,
                                0.0017704,0.0018774,0.0019763,0.0020674,0.0021505,0.0022258,0.0022934,0.0023534,
                                0.0024059,0.002451,0.0024889,0.0025196,0.0025434,0.0025604,0.0025708,0.0025747,
                                0.0025724,0.0025641,0.0025499,0.00253,0.0025048,0.0024743,0.0024389,0.0023988,
                                0.0023541,0.0023052,0.0022522,0.0021955,0.0021352,0.0020717,0.0020051,0.0019357,
                                0.0018637,0.0017894,0.0017131,0.0016349,0.0015552,0.0014741,0.0013918,0.0013087,
                                0.0012249,0.0011407,0.0010562,0.00097171,0.00088739,0.00080344,0.00072006,0.00063743,
                                0.00055573,0.00047513,0.00039578,0.00031786,0.0002415,0.00016684,9.4022e-05,2.3164e-05,
                                -4.5618e-05,-0.00011222,-0.00017653,-0.00023847,-0.00029795,-0.0003549,-0.00040926,
                                -0.00046096,-0.00050995,-0.0005562,-0.00059967,-0.00064034,-0.00067818,-0.00071319,
                                -0.00074536,-0.0007747,-0.00080122,-0.00082493,-0.00084587,-0.00086406,-0.00087954,
                                -0.00089236,-0.00090255,-0.00091018,-0.00091531,-0.00091799,-0.0009183,-0.00091631,
                                -0.00091209,-0.00090573,-0.0008973,-0.0008869,-0.00087461,-0.00086052,-0.00084473,
                                -0.00082732,-0.0008084,-0.00078807,-0.00076642,-0.00074355,-0.00071956,-0.00069455,
                                -0.00066861,-0.00064185,-0.00061437,-0.00058625,-0.0005576,-0.00052851,-0.00049908,
                                -0.00046938,-0.00043951,-0.00040956,-0.00037961,-0.00034974,-0.00032002,-0.00029054,
                                -0.00026137,-0.00023257,-0.00020421,-0.00017636,-0.00014907,-0.00012239,-9.6392e-05,
                                -7.1108e-05,-4.6587e-05,-2.2872e-05,1.6959e-18,2.1996e-05,4.3084e-05,6.3239e-05,
                                8.2437e-05,0.00010066,0.00011789,0.00013411,0.00014932,0.00016351,0.00017668,0.00018882,
                                0.00019994,0.00021005,0.00021916,0.00022728,0.00023441,0.00024059,0.00024582,0.00025014,
                                0.00025356,0.0002561,0.00025781,0.00025869,0.00025879,0.00025814,0.00025677,0.00025472,
                                0.00025201,0.00024868,0.00024478,0.00024033,0.00023538,0.00022996,0.00022411,0.00021787,
                                0.00021127,0.00020435,0.00019715,0.00018971,0.00018206,0.00017424,0.00016628,0.00015821,
                                0.00015007,0.00014188,0.00013369,0.00012551,0.00011738,0.00010932,0.00010136,9.3522e-05,
                                8.583e-05,7.8304e-05,7.0964e-05,6.3829e-05,5.6915e-05,5.0237e-05]

    def __init__(self, filter_type):
        # Selection of used filter
        if filter_type == 'highpass_HR':
            self.coefficients = Filter.coefficients_highpass_HR
        elif filter_type == 'lowpass_HR':
            self.coefficients = Filter.coefficients_lowpass_HR
        elif filter_type == 'highpass_RR':
            self.coefficients = Filter.coefficients_highpass_RR
        elif filter_type == 'lowpass_RR':
            self.coefficients = Filter.coefficients_lowpass_RR
        
        self.length_of_input_vector = len(self.coefficients)            # Length of coefficient vector and length of input vector
        self.input_vector = np.zeros(self.length_of_input_vector)       # Vector of the same length as coefficients
        self.input_vector_index = 0                                     # To know where the latest input value is in input_vector

    def filter(self, input_value):      # Filters the input value
        self.input_vector[self.input_vector_index] = input_value        # Saves the input data continuously in a vector
        output = 0                                                      # The filtered value. Add all coefficients * (input values) together

        iterate_index = self.input_vector_index                     # Because variable value is changed in order to loop array
        for i in range(0, self.length_of_input_vector - 1):         # Iterate over all coefficients and relevant input values
            if iterate_index - i < 0:                               # If iterate_index is negative, then begin from right hand side and work our way to the left in array
                iterate_index = self.length_of_input_vector + i - 1         # Moving to the rightmost location of array
            output += self.coefficients[i] * self.input_vector[iterate_index - i]       # Add value of coefficient * data

        self.input_vector_index += 1                                    # Note that index is incremented before if statement
        if self.input_vector_index == self.length_of_input_vector:      # Add values from beginning of array if overflow
            self.input_vector_index = 0
        return output