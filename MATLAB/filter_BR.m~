function [S_o] = filter_BR(S_i,Fs,BW)
%This function detects and removes the breathing and all it's harmonics,
%assuming it's the strongest tone.
%   Detailed explanation goes here
    F_resolution = 1/60;
    beta = 0.1;
    [f,S_i_fft] = smartFFT_abs(S_i,Fs,F_resolution,beta);
    %Does an FFT on the input signal to detect the strongest signal
    
    [val_mins,I_mins] = max(S_i_fft);
    
    i_max = I(1);
    f_max = f(i_max);
    %choose the first maximum value to remove it and it's harmonics
    
    [num,den] = iircomb(n,bw)
    
    fs = 600; fo = 60;  q = 35; bw = (f_max/(Fs/2))/q;
    [b,a] = iircomb(Fs/f_max,bw,'notch'); % Note type flag 'notch'
    fvtool(b,a);

end

